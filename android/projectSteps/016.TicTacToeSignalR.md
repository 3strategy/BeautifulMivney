---
layout: page
title: "×—×™×‘×•×¨ ××©×—×§ ××™×§×¡ ×¢×™×’×•×œ ×œÖ¾SignalR"
subtitle: "××××©×—×§ ×œ×•×§××œ×™ ×œ××©×—×§ ××¨×•×‘×” ××©×ª×ª×¤×™×"
tags: [×× ×“×¨×•××™×“, SignalR, ×¨×©×ª, Realtime, Java,×× ×™×¤×¡×˜, ×”×¨×©××ª ××™× ×˜×¨× ×˜, manifest, ×¡× ×›×¨×•×Ÿ, ×œ×¡× ×›×¨×Ÿ,permissions, AndroidStudio]
lang: he
---

{: .box-note}
×‘××“×¨×™×š ×–×” × ×œ××“ ×›×™×¦×“ ×œ×”×¨×—×™×‘ ××ª ××¤×œ×™×§×¦×™×™×ª ×”Ö¾Tic Tac Toe (××™×§×¡ ×¢×™×’×•×œ) ×›×š ×©×©× ×™ ××›×©×™×¨×™ ×× ×“×¨×•××™×“ ×™×•×›×œ×• ×œ×©×—×§ ××—×“ ××•×œ ×”×©× ×™ ×“×¨×š ×©×¨×ª **SignalR**.

×œ×¤× ×™ ×©××ª×—×™×œ×™× ×¢×‘×•×“×”, ×™×© ×œ×•×•×“× ×©×¨×¥ ×‘×›×™×ª×” (××• ×‘×‘×™×ª) ×©×¨×ª SignalR. [×‘×§×™×©×•×¨ ×–×” ×™×© ConsoleApp ×§×˜×Ÿ ×©×œ ×©×¨×ª ×›×–×”](https://github.com/3strategy/ConsoleSignalRCore6). ××¤×©×¨ ×¤×©×•×˜ ×œ×”×•×¨×™×“ ×•×œ×”×¨×™×¥ ×‘×¨×©×ª ×”××§×•××™×ª ×‘×›×™×ª×”. ××¤×©×¨ ×œ×§×•×•×ª ×©×”×©×¨×ª ×©××™×¨×’× ×ª×™ ×‘×›×ª×•×‘×ª ×©×‘×”××©×š, ×¨×¥ ×›×¨×’×¢.

* ×¢×“×›×•×Ÿ ×©×œ ×”×¨×’×¢ ×”××—×¨×•×Ÿ: ×›×™×•×•×Ÿ ×©×‘×‘×™×ª ×”×¡×¤×¨ ×—×•×¡××™× ×™×¦×™××” ×œ-port 8081 ×¢×“×›× ×ª×™ ××ª ×”×¡×‘×™×‘×” ×”×ª×•××›×ª ×œ-port 80. **×™×© ×œ×¢×“×›×Ÿ ×‘×§×•×“ ×©×œ×›× ×8081 ×œ-80 - ×‘×¤×¨×˜ ×‘×§×•×‘×¥ ×”-Service.**


<details markdown="1"><summary>××” ×–×” ×‘×›×œ×œ SignalR?</summary>
SignalR ×”×™× ×¡×¤×¨×™×™×ª ×§×•×“ ×¤×ª×•×— ×©×œ ××™×§×¨×•×¡×•×¤×˜ ×©××™×•×¢×“×ª ×œ×”×•×¡×¤×ª **×™×›×•×œ×•×ª ×ª×§×©×•×¨×ª ×‘×–××Ÿ ×××ª** ×œ××¤×œ×™×§×¦×™×•×ª ××™× ×˜×¨× ×˜. ×”×™× ×××¤×©×¨×ª ×œ×©×¨×ª ×œ×©×œ×•×— ×¢×“×›×•× ×™× ×™×©×™×¨×•×ª ×œ×œ×§×•×—×•×ª (×œ××©×œ ×“×¤×“×¤× ×™×) ×‘××•×ª×• ×”×¨×’×¢ ×‘×• ××ª×‘×¦×¢ ×©×™× ×•×™, **×‘×œ×™ ×¦×•×¨×š ×‘×¨×¢× ×•×Ÿ ×”×“×£**. SignalR ×ª×•××›×ª ×‘×™×›×•×œ×•×ª ×›××• ×¦'××˜ ×—×™, ×¢×“×›×•× ×™× ×‘×œ×•×—×•×ª ××™×“×¢ ×•××©×—×§×™× ××¨×•×‘×™ ××©×ª×ª×¤×™×, ×•×›×œ ×–××ª ×‘×¢×–×¨×ª ××•×“×œ ×ª×›× ×•×ª ×¤×©×•×˜ ×‘Ö¾C#. ×”×™× ××‘×¦×¢×ª ××•×¤×˜×™××™×–×¦×™×” ××•×˜×•××˜×™×ª ×œ×¡×•×’ ×”×ª×§×©×•×¨×ªâ€”×œ×“×•×’××”, WebSockets, Server-Sent Events ××• Long Pollingâ€”×œ×¤×™ ××” ×©×”×“×¤×“×¤×Ÿ ×ª×•××š ×‘×•. SignalR ×× ×”×œ×ª ×‘×¢×¦××” ××ª ×›×œ ×ª×”×œ×™×š ×”×—×™×‘×•×¨ ×•×”×¢×“×›×•×Ÿ ××•×œ ×”×œ×§×•×—, ×•××¡×¤×§×ª API ×§×œ ×•× ×•×— ×œ×”×¤×¦×ª ×”×•×“×¢×•×ª ×•×§×‘×œ×ª ××™×“×¢ ×‘×–××Ÿ ×××ª. ×”×ª××™×›×” ×”×™× ×›××•×‘×Ÿ ×œ× ×¨×§ ×‘×“×¤×“×¤×Ÿ ×•×§×™×™××•×ª ×¡×¤×¨×™×•×ª ×”×××¤×©×¨×•×ª ×œ×”×ª×—×‘×¨ ×××¤×œ×™×§×¦×™×•×ª, ×›×•×œ×œ Android Java ×›××• ×›××Ÿ.
</details>

×”××™××•×© ×‘×œ×§×•×— ×”×× ×“×¨×•××™×“ ××ª×—×™×œ ×œ××—×¨ ×©××™××©× ×• ××©×—×§ ××™×§×¡ ×¢×™×’×•×œ ×”××™××•×© ×›××Ÿ ××ª×—×™×œ ×××¤×œ×™×§×¦×™×” ×§×™×™××ª ×©×”×›× × ×• ×‘×©×™×¢×•×¨×™× 014a 014b 015a [015b](/android/projectSteps/015b.AddingTicTacToeToMainActivity). × ×™×ª×Ÿ ×œ×××© ×‘××•×¤×Ÿ ×“×•××” ×¢×œ ×›×œ ××¤×œ×™×§×¦×™×” ×‘×©×™× ×•×™×™× ××¡×•×™×™××™×.

× ×—×œ×§ ××ª ×”×¢×‘×•×“×” ×œ×©×œ×•×©×” ×©×œ×‘×™× ×¢×™×§×¨×™×™×, ×©×›×œ ××—×“ ××”× ×ª×•×× ×œ×§×•××™×˜ ×©×ª×‘×¦×¢×• ×‘Ö¾Git:

1. **×—×™×‘×•×¨ ×œ-SignalR + ×”×’×“×¨×ª ××‘×˜×—×” ×œ-HTTP**
2. **×©×œ×™×—×ª ××”×œ×š (Send Key)**  
3. **×§×‘×œ×ª ××”×œ×š ×•×©×™×œ×•×‘×• ×‘×œ×•×’×™×§×ª ×”××©×—×§**

---

## ×©×œ×‘ 1 â€“ ×”×ª×—×‘×¨×•×ª ×œÖ¾SignalR

{: .box-note}
×‘×©×œ×‘ ×–×” × ×’×“×™×¨ ××ª ×›×œ ×”×ª×©×ª×™×ª ×œ×”×ª×—×‘×¨×•×ª ×œ×©×¨×ª SignalR ×“×¨×š ×›×ª×•×‘×ª IP ××§×•××™×ª, ×•× ××¤×©×¨ ×ª×§×©×•×¨×ª **HTTP** ×¨×’×™×œ×” (×œ× ×××•×‘×˜×—×ª) ×œ×¦×•×¨×›×™ ×¤×™×ª×•×—.

### ×§×‘×¦×™× ×©×™×¢×•×“×›× ×•

- `activity_main.xml` (×ª×•×¡×¤×ª UI - ×”×’×“×¨×ª IP ×•×›×¤×ª×•×¨ ×”×ª×—×‘×¨×•×ª)
- `network_security_config.xml` (×”×§×œ×•×ª ××‘×˜×—×”: ××™×¤×©×•×¨ http)
- `AndroidManifest.xml` (×‘×§×©×ª ×”×¨×©××ª ××™× ×˜×¨× ×˜, ×•×”×§×œ×•×ª ××‘×˜×—×”)
- `build.gradle` (×›×™×•×•×Ÿ ×©×× ×• ××•×¡×™×¤×™× ×¡×¤×¨×™×•×ª)
- `SignalRService.java` (×§×•×‘×¥ ×—×“×© ×ª××™×›×ª ×œ×§×•×— ×‘-SignalR)
- `MainActivity.java`

### ×ª×¨×©×™× ×ª×”×œ×™×š

```mermaid

graph TD
A[MainActivity] -->|connect click| B[SignalRService.connect]
B -->|HTTP hub connection| C[SignalR Server]
C -->|ReceiveMessage / ReceiveKey| B
B -->|log / callback| A

```

### ×¢×™×§×¨×™ ×”×§×•×“

#### ×”×•×¡×¤×ª ×”×’×“×¨×” ×œ×”×¨×©××ª ×ª×§×©×•×¨×ª HTTP

{: .box-success}
× ×™×¦×•×¨ ×§×•×‘×¥ ×—×“×© ×ª×—×ª  `res/xml/`  ×‘×©× `network_security_config.xml` ×™×© ×œ×”×ª××™× ××ª ×›×ª×•×‘×ª ×”-ip ×œ×–×• ×©×œ ×©×¨×ª ×”-SignalR ×©×‘×›×™×ª×”:

```xml
<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <domain-config cleartextTrafficPermitted="true">
        <domain includeSubdomains="false">109.226.44.197</domain>
    </domain-config>
</network-security-config>
```

×”×¢×¨×”: ×©×œ×‘ ×–×” **×”×›×¨×—×™** ××¤× ×™ ×©×‘×’×¨×¡××•×ª ×× ×“×¨×•××™×“ ×—×“×©×•×ª ×©×™××•×© ×‘-http ×˜×§×¡×˜ ×’×œ×•×™ ×—×¡×•× ×›×‘×¨×™×¨×ª ××—×“×œ. ×”×¨×¦×•×ª ×©×œ https:// ××•×¨×›×‘×•×ª ×™×•×ª×¨

× ×•×¡×™×£ **×××© ×œ××¢×œ×”** ×‘×§×•×‘×¥ ×”×× ×™×¤×¡×˜ `app\src\main\AndroidManifest.xml` ×‘×§×©×ª ×”×¨×©××ª ××™× ×˜×¨× ×˜:

{% highlight diff %}
+    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:allowBackup="true"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Holo.Light.DarkActionBar"
        android:networkSecurityConfig="@xml/network_security_config">
        <activity
            android:name=".MainActivity"
{% endhighlight %}

### ×¢×™×¦×•×‘ ×××©×§ ×”××©×ª××©

× ×¢×“×›×Ÿ ××ª ×§×•×‘×¥ `activity_main.xml` ×›×š ×©×™×›×œ×•×œ ×©×“×” ×œ×”×–× ×ª ×›×ª×•×‘×ª ×”×©×¨×ª ×•×›×¤×ª×•×¨ ×—×™×‘×•×¨:

{% highlight diff xml mark_lines="6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28" %}
<LinearLayout
    android:orientation="vertical"
    android:gravity="center"
    android:padding="16dp">

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:gravity="center"
        android:layout_marginBottom="12dp">

        <EditText
            android:id="@+id/editServerIP"
            android:layout_width="160dp"
            android:layout_height="wrap_content"
            android:hint="109.226.44.197"
            android:inputType="text"
            android:importantForAutofill="no" />

        <Button
            android:id="@+id/buttonConnect"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginStart="8dp"
            android:onClick="onConnectClick"
            android:text="Connect" />
    </LinearLayout>

+    <!-- ×›×œ ×”×”××©×š ×©×›××Ÿ ×œ×œ× ×©×™× ×•×™ -->
    <GridLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:columnCount="3"
            android:rowCount="3">

            <Button.....

{% endhighlight %}

### × ×¢×“×›×Ÿ ×—×‘×™×œ×•×ª ×—×“×©×•×ª ×‘-build.gradle (Module:app)

{% highlight diff %}
dependencies {
// keep all the existing stuff.


+    implementation 'com.microsoft.signalr:signalr:8.0.0'
}
{% endhighlight %}

×œ××—×¨ ×©×™× ×•×™ ×‘×’×¨×™×™×“×œ, ×™×© ×œ×¡× ×›×¨×Ÿ ××ª ×”×¤×¨×•×™×™×§×˜ ×‘×××¦×¢×•×ª ×”×›×¤×ª×•×¨ ×”×–×”:
![alt text](/assets/img/05Tic/image.png)

### × ×™×¦×•×¨ ××ª ××—×œ×§×ª SignalRService.java

×”×§×•×‘×¥ ××•×‘× ×›××Ÿ ×‘××œ×•××• ×•×›×•×œ×œ ×›×‘×¨ ××ª ×”×©×™× ×•×™×™× ×©× ×¢×©×• ×‘×©×œ×‘×™ ×”×”××©×š

<details open markdown="1"><summary>SignalRService.java ×§×•×‘×¥ ×©×œ× ×œ×”×•×¡×¤×”</summary>

``` java
package com.example.tictacmenu.services;

import android.util.Log;

import com.microsoft.signalr.HubConnection;
import com.microsoft.signalr.HubConnectionBuilder;
import com.microsoft.signalr.HubConnectionState;

public class SignalRService {
    private static final String TAG = "SignalRService";

    private HubConnection connection;

    public interface Listener {
        void onConnected();
        void onDisconnected(Throwable error);
        void onReceiveMessage(String user, String message);
        void onReceiveKey(String key);
    }

    public void connect(String baseIp, Listener listener) {
        // Build hub URL: http://<ip>:80/gamehub
        final String url = "http://" + baseIp + ":80/gamehub";

        // Dispose previous connection if exists
        if (connection != null) {
            try { connection.stop(); } catch (Exception ignored) {}
            connection = null;
        }

        connection = HubConnectionBuilder.create(url).build();

        // Subscriptions
        connection.on("ReceiveMessage", (user, message) -> {
            Log.d(TAG, "ReceiveMessage: " + user + ": " + message);
            if (listener != null) listener.onReceiveMessage(user, message);
        }, String.class, String.class);

        connection.on("ReceiveKey", (key) -> {
            Log.d(TAG, "ReceiveKey: " + key);
            if (listener != null) listener.onReceiveKey(key);
        }, String.class);

        // Connect on background thread
        new Thread(() -> {
            try {
                connection.start().blockingAwait();
                Log.d(TAG, "Connected to " + url);
                if (listener != null) listener.onConnected();

                // Debug: send a test message like the C# sample
                try {
                    connection.send("SendMessage", "Jojo", "Hello everybody");
                } catch (Throwable t) {
                    Log.w(TAG, "SendMessage failed: " + t.getMessage());
                }
            } catch (Throwable t) {
                Log.e(TAG, "Hub exception: " + t.getMessage());
                if (listener != null) listener.onDisconnected(t);
            }
        }).start();
    }

    public void disconnect() {
        if (connection != null) {
            try {
                connection.stop().blockingAwait();
            } catch (Throwable ignored) {
            } finally {
                connection = null;
            }
        }
    }

    public boolean isConnected() {
        return connection != null && connection.getConnectionState() == HubConnectionState.CONNECTED;
    }

    public void sendMove(int row, int col, String player) {
        // Encode move as "row,col,player" for server-side handling
        String key = row + "," + col + "," + player;
        sendKey(key);
    }

    public void sendKey(String key) {
        if (connection == null) {
            Log.w(TAG, "sendKey called but connection is null");
            return;
        }
        try {
            connection.send("SendKey", key);
        } catch (Throwable t) {
            Log.e(TAG, "Failed to send key: " + t.getMessage());
        }
    }
}
```

</details>

<details open markdown="1"><summary>×ª×•×¡×¤×•×ª ×‘××—×œ×§×” MainActivity.java</summary>

```java
// ×”×•×¡×¤×ª ××™××¤×•×¨×˜ ××¢×œ ×”××—×œ×§×”
import android.util.Log;
import android.widget.EditText;
import com.example.tictacmenu.services.SignalRService;

```

---

```java
// ×”×•×¡×¤×ª ×‘×ª×•×š ×”××—×œ×§×”
private final SignalRService signalRService = new SignalRService();
private static final String TAG = "MainActivity";


// ×”×ª×—×‘×¨×•×ª ×•×”×¤×¢×œ×ª ×××–×™× ×™× ×œ×©×¨×ª
public void onConnectClick(View view) {
    EditText ipEdit = findViewById(R.id.editServerIP);
    String ip = ipEdit.getText().toString().trim();
    if (ip.isEmpty()) {
        // Fall back to hint if empty
        ip = ipEdit.getHint() != null ? ipEdit.getHint().toString() : "109.226.44.197";
    }

    String finalIp = ip;
    Toast.makeText(this, "Connecting to " + finalIp + ":8081", Toast.LENGTH_SHORT).show();
    signalRService.connect(finalIp, new SignalRService.Listener() {
        @Override
        public void onConnected() {
            runOnUiThread(() -> Toast.makeText(MainActivity.this, "Connected to hub", Toast.LENGTH_SHORT).show());
        }

        @Override
        public void onDisconnected(Throwable error) {
            runOnUiThread(() -> Toast.makeText(MainActivity.this, "Hub error: " + (error != null ? error.getMessage() : "unknown"), Toast.LENGTH_LONG).show());
        }

        @Override
        public void onReceiveMessage(String user, String message) {
            Log.d(TAG, "we got " + message + " from " + user);
        }

        @Override
        public void onReceiveKey(String key) {
            // ×‘×”××©×š × ×˜×¤×œ ×›××Ÿ ×‘×§×‘×œ×ª ××™×“×¢ ××”×©×¨×ª
            Log.d(TAG, "HandleOthersKey: " + key);
        }
    });
}
```

</details>

### ×ª×•×¦××” ×¦×¤×•×™×”

×œ××—×¨ ×¡× ×›×¨×•×Ÿ ×”×¤×¨×•×™×§×˜ ×‘×¢×§×‘×•×ª ×©×™× ×•×™ ×”-gradle, × ×™×ª×Ÿ ×œ×”×¨×™×¥ ××•×ª×•. ×œ××—×¨ ×œ×—×™×¦×” ×¢×œ **Connect**, ×ª×•×¦×’ ×”×•×“×¢×ª "Connected" ××• "Failed" ×‘×”×ª×× ×œ××¦×‘ ×”×©×¨×ª. ×™×ª×›×Ÿ ×©×™×”×™×” ×¦×•×¨×š ×‘×¦×“ ×©×œ×™ ×œ×©× ×•×ª ×”×’×“×¨×•×ª ×‘××™×“×” ×©××‘×™×ª ×”×¡×¤×¨ ×”×¤×•×¨×˜ ××œ×™×• ×× ×• × ×™×’×©×™× ×—×¡×•×.

**×”×©×¨×ª - ××™× ×• ×©×¨×ª ×–××™× ×•×ª ×’×‘×•×”×”. ×××•×¨ ×œ×¢×‘×•×“ ×‘×™×•× ×™×•× ×‘×©×¢×•×ª ×”×™×•× ×•×‘×—×œ×§ ××©×¢×•×ª ×”×œ×™×œ×”**

**×‘×¡×™×•× ×©×œ×‘ ×–×” commit and push**
---

## ×©×œ×‘ 2 â€“ ×©×œ×™×—×ª ××”×œ×š (Send Key)

{: .box-note}
×‘×©×œ×‘ ×–×” × ×•×¡×™×£ ×©×œ×™×—×ª ××”×œ×š ×œ×©×—×§×Ÿ ×”××§×•××™ â€” ×›×œ ×œ×—×™×¦×” ×¢×œ ×ª× ×‘×œ×•×— ×ª×©×“×¨ ×œ×©×¨×ª ××ª ×”××”×œ×š ×©× ×‘×—×¨ (×©×•×¨×”, ×¢××•×“×”, ×•×¡×™××Ÿ X ××• O).

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

- `MainActivity.java`
- `SignalRService.java` (×©×™× ×•×™×™× ××œ×• ×›×‘×¨ ×›×œ×•×œ×™× ×‘×§×•×‘×¥ ×©×œ×¢×™×œ)

### ×œ×•×’×™×§×” ×›×œ×œ×™×ª

```mermaid
graph TB
A["onCellClick(row,col)"] --> B[model.setMove]
B --> C["SignalRService.sendMove(row,col,player)"]
C --> D[SignalR Server]
```

### ×ª×•×¡×¤×ª ×œ- MainActivity

{% highlight diff mark_lines="3 5 6 7" %}
        if (model.isLegal(row, col)) {
            model.makeMove(row, col);
-           String player = model.getCurrentPlayer();

-           button.setText(model.getCurrentPlayer());

+           button.setText(player);
-           // Send the move to the hub: "row,col,player"
-           signalRService.sendMove(row, col, player);
            
            if (model.checkWin()) {
                model.changePlayer();

{% endhighlight %}

### ×“×•×’××ª ×§×•×“ ××ª×•×š `SignalRService.java` (×›×‘×¨ ×§×™×™×)

```java
public void sendMove(int row, int col, String player) {
    if (hubConnection != null && hubConnection.getConnectionState() == HubConnectionState.CONNECTED) {
        String key = row + "," + col + "," + player;
        hubConnection.send("SendKey", key);
    }
}
```

### ×ª×•×¦××” ×¦×¤×•×™×”

×‘×œ×—×™×¦×” ×¢×œ ×ª× ×‘×œ×•×—, ×”×©×¨×ª ×™×¦×™×’ ×‘×§×•× ×¡×•×œ ×”×•×“×¢×” ×›×’×•×Ÿ:

```
Hub received key: 1,2,X
```

---

## ×©×œ×‘ 3 â€“ ×§×‘×œ×ª ××”×œ×š ×•×©×™×œ×•×‘ ×‘×œ×•×’×™×§×ª ×”××©×—×§

{: .box-note}
×‘×©×œ×‘ ×–×” × ×—×‘×¨ ××ª ×”××™×¨×•×¢ **ReceiveKey** ××”×©×¨×ª ×›×š ×©×›×œ ××›×©×™×¨ ×™×¢×“×›×Ÿ ××ª ×”×œ×•×— ××•×˜×•××˜×™×ª ×‘×¢×ª ×§×‘×œ×ª ××”×œ×š ××”×©×—×§×Ÿ ×”×©× ×™.

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

- `MainActivity.java`
- `TicTacToeModel.java`

### ×ª×¨×©×™× ×–×¨×™××”

```mermaid
graph TD
A[SignalR ReceiveKey] --> B[parse key â†’ row,col,player]
B --> C["model.setMove(row,col,player)"]
C --> D[update UI button]
D --> E["()changePlayer"]
```

### ×¢×“×›×•×Ÿ on("ReceiveKey" ×‘- `MainActivity.java`

```java
        @Override
        public void onReceiveKey(String key) {
            // ×‘×”××©×š × ×˜×¤×œ ×›××Ÿ ×‘×§×‘×œ×ª ××™×“×¢ ××”×©×¨×ª
            Log.d(TAG, "HandleOthersKey: " + key);
            // Expecting format: "row,col,player"
            String[] parts = key.split(",");
            if (parts.length != 3) {
                return;
            }
            try {
                int r = Integer.parseInt(parts[0].trim());
                int c = Integer.parseInt(parts[1].trim());
                String p = parts[2].trim();

                runOnUiThread(() -> {
                    // Only apply if the cell is still empty
                    if (model.isLegal(r, c)) {
                        boolean applied = model.setMove(r, c, p);
                        if (applied) {
                            int id = idFor(r, c);
                            if (id != 0) {
                                Button target = findViewById(id);
                                if (target != null) {
                                    target.setText(p);
                                }
                            // Optional: win/tie checks would go here if implemented

                            // Keep turn alternation consistent with local logic
                            }
                            model.changePlayer();
                        }
                    }
                });
            } catch (NumberFormatException e) {
                Log.w(TAG, "Bad key format: " + key);
            }
        }
    });
}



private int idFor(int row, int col) {
    if (row == 0 && col == 0) return R.id.button00;
    if (row == 0 && col == 1) return R.id.button01;
    if (row == 0 && col == 2) return R.id.button02;
    if (row == 1 && col == 0) return R.id.button10;
    if (row == 1 && col == 1) return R.id.button11;
    if (row == 1 && col == 2) return R.id.button12;
    if (row == 2 && col == 0) return R.id.button20;
    if (row == 2 && col == 1) return R.id.button21;
    if (row == 2 && col == 2) return R.id.button22;
    return 0;
}
```

### ×”×•×¡×¤×ª ×¤×¢×•×œ×” ×‘×§×•×‘×¥ `TicTacToeModel.java`

{% highlight java mark_lines="2" %}
// ×˜×™×¤×•×œ ×‘××”×œ×š ××©×—×§ ×©×”×ª×§×‘×œ ××”×©×¨×ª (used for remote moves)
public boolean setMove(int row, int col, String player) {
    if (isLegal(row, col)) {
        board[row][col] = player;
        return true;
    }
    return false;
}
{% endhighlight %}

### ×ª×•×¦××” ×¦×¤×•×™×”

×›××©×¨ ×©× ×™ ××›×©×™×¨×™× ××—×•×‘×¨×™× ×œ××•×ª×• ×©×¨×ª SignalR, ×›×œ ××”×œ×š ×™×ª×¢×“×›×Ÿ **××™×™×“×™×ª** ×‘×¦×“ ×”×©× ×™ â€“ ×”××©×—×§ ×”×•×¤×š ×œ×¨×‘Ö¾××©×ª×ª×¤×™× ×‘×–××Ÿ ×××ª.

---

## ×¡×™×›×•×

{: .box-success}
×—×™×‘×¨× ×• ××ª ××©×—×§ ×”××™×§×¡ ×¢×™×’×•×œ ×œ-SignalR ğŸ®  
××¢×ª×” × ×™×ª×Ÿ ×œ×©×—×§ ×‘×™×Ÿ ×©× ×™ ××›×©×™×¨×™× ××• ×™×•×ª×¨ ×‘×–××Ÿ ×××ª.

×‘×©×œ×‘×™× ×”×‘××™× ×ª×•×›×œ×• ×œ×”×•×¡×™×£:

- ×¡× ×›×¨×•×Ÿ ×ª×•×¦××•×ª (× ×™×¦×—×•×Ÿ/×”×¤×¡×“)
- ×ª××™×›×” ×‘××¡×¤×¨ ×—×“×¨×™× (rooms)
- ×§×™×‘×•×¢ ×”×©×—×§×Ÿ ×‘× ×™×™×“ ×©×œ ×”××©×ª××© ×›×š ×©×œ× ×™×•×›×œ ×œ×©×—×§ ××ª ×©× ×™ ×”×¦×“×“×™×

---

## ×ª×¤×¢×•×œ ×ª×§×œ×•×ª ×•×”× ×’×©×ª ×©×¨×ª

* ×‘××™×“×” ×©×”×©×¨×ª ××¦×œ×™ ×œ× ×¨×¥, ××•××œ×¥ ×©××—×“ ×”××—×©×‘×™× ×”××—×•×‘×¨×™× ×‘-wifi ×™×¨×™×¥ ××ª ×”×©×¨×ª. ×›×š ×™×•×ª×¨ ××—×©×‘×™× × ×™×™×“×™× ×•×˜×œ×¤×•× ×™× × ×™×™×“×™× ×™×•×›×œ×• ×œ×”×ª×—×‘×¨.
* ×™×© ×œ×¢×“×›×Ÿ ××ª ×”×›×ª×•×‘×ª ×‘×§×•×‘×¥ `network_security_config`, ×œ×›×ª×•×‘×ª ×‘×” ×××–×™×Ÿ ×”×©×¨×ª.
* ×œ×‘×“×™×§×ª ×–××™× ×•×ª ×©×œ ×”×©×¨×ª ××”×›×™×ª×” × ×™×ª×Ÿ ×œ×”×¨×™×¥ ××ª ×”×¤×§×•×“×” ×”×‘××” ×‘- Power Shell.

  `Test-NetConnection -ComputerName 109.226.44.197 -Port 80`

[×§×™×©×•×¨ ×œ×’×™×˜.](https://github.com/3strategy/TicTacToeSignalR) ×©×™××• ×œ×‘ ×©××‘× ×” ×”×ª×™×§×™×•×ª ×•×ª×¤×¨×™×˜ ×”××‘×•×¨×’×¨ ×©×‘× ×™× ×• ××™× ×• ×—×œ×§ ××”-repo ×”×–×” ×©××“×’×™× ×¨×§ ×—×™×‘×•×¨ ×œ-signalR
